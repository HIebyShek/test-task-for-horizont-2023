# This starter workflow is for a CMake project running on multiple platforms. There is a different starter workflow if you just want a single platform.
# See: https://github.com/actions/starter-workflows/blob/main/ci/cmake-single-platform.yml
name: CMake on multiple platforms

on:
  push:
    branches: [ "master" ]
  pull_request:
    branches: [ "master" ]

jobs:
  build:
    runs-on: ${{ matrix.os }}

    strategy:
      # Set fail-fast to false to ensure that feedback is delivered for all matrix combinations. Consider changing this to true when your workflow is stable.
      fail-fast: false

      matrix:
        os: [ubuntu-latest, windows-latest]
        build_type: [debug, release]

    steps:
    - uses: actions/checkout@v3
<<<<<<< HEAD
<<<<<<< HEAD
    
    - name: Setup Ninja
      uses: ashutoshvarma/setup-ninja@v1.1
=======
    
    - name: Setup Ninja
      uses: ashutoshvarma/setup-ninja@v1.1
<<<<<<< HEAD
      with:
        version: 1.10
        platform: [linux, win]
>>>>>>> 47e3d34 (Update cmake-multi-platform.yml)
=======
>>>>>>> adde8b2 (Update cmake-multi-platform.yml)

    - name: update submodules
<<<<<<< HEAD
<<<<<<< HEAD
      run: git submodule update --init external/doctest
      
=======

>>>>>>> d63bb6f (Create cmake-multi-platform.yml)
=======
      run: git submodule --init update external/doctest
=======
      run: git submodule update --init external/doctest
>>>>>>> 3da6dd4 (Update cmake-multi-platform.yml)
      
>>>>>>> acaf81b (Update cmake-multi-platform.yml)
    - name: Configure CMake
      run: cmake --preset ${{ matrix.build_type }}

    - name: Build
<<<<<<< HEAD
<<<<<<< HEAD
      run: cmake --build --preset ${{ matrix.build_type }}

    - name: Test
      run: ${{ github.workspace }}/build/${{ matrix.build_type }}/tests
=======
      # Build your program with the given configuration. Note that --config is needed because the default Windows generator is a multi-config generator (Visual Studio generator).
      run: cmake --build --preset ${{ matrix.build_type }}

    - name: Test
<<<<<<< HEAD
      run: ./build/${{ matrix.build_type }}/test
>>>>>>> d63bb6f (Create cmake-multi-platform.yml)
=======
      run: ${{ github.workspace }}/build/${{ matrix.build_type }}/test
>>>>>>> 57bff61 (Update cmake-multi-platform.yml)
=======
      run: cmake --build --preset ${{ matrix.build_type }}

    - name: Test
      run: ${{ github.workspace }}/build/${{ matrix.build_type }}/tests
>>>>>>> f7ef534 (Update cmake-multi-platform.yml)
